Webserv – To‑Do List [MISE À JOUR Nov 23, 2025]

avancement projet : ~96% (Module CGI opérationnel, restent finitions ciblées)

Ordre recommandé pour finir
1) Config: upload_store (chemin d'upload) [ ] - Parsing à faire pour être propre
2) Config: cgi_pass (extension -> exécutable) [ ] - Associer .py/.php -> chemin CGI
3) CGI: implémenter le module CGI ✅ (base OK: fork/exec, pipe, sortie capturée)
4) CGI: variables d'environnement complètes (PATH_INFO, SCRIPT_FILENAME, SERVER_SOFTWARE, etc.) [ ]
5) CGI: chdir dans répertoire du script avant execve [ ]
6) CGI: timeout d'exécution pour éviter blocage/zombie [ ]
7) Validation: Stress tests (concurrence + uploads + CGI) et vérifications finales [ ]

Exécution
- ✅ Fichier de configuration par défaut si aucun argument (ex: conf_file/default.conf)

Réseau / IO (non bloquant)
- ✅ Sockets non-bloquants + epoll unique
- ✅ Bases en place pour lecture/écriture (acceptClient, handleReadEvent, handleWriteEvent)
- ✅ Surveiller LECTURE ET ÉCRITURE simultanément
- ✅ Gérer envois partiels (sendBuffers_, sendOffsets_)
- ✅ Events géré via epoll (EPOLLIN/EPOLLOUT)
- ✅ Gestion des timeouts (clientTimeout_)
- ✅ Timeout requests (must never hang indefinitely) - Implemented

HTTP Core
- ✅ Parsing des headers basique
- ✅ Extraction method/uri/body
- ✅ Gestion Content-Length
- ✅ Transfer-Encoding: chunked (Supporté en lecture et parsing)
- ✅ Entêtes uniformes: Server + Connection: close
- ✅ Date (RFC1123)
- ✅ Content-Type/MIME par extension
- ✅ 405 si méthode invalide
- ✅ 400 si Host manquant (HTTP/1.1)
- ✅ Compatible with standard web browsers

Méthodes
- ✅ GET basique (fichiers statiques, getHtmlPage)
- ✅ DELETE (suppression de fichier)
- ✅ POST: upload basique et multipart implémenté
- ✅ PUT: implémenté (upload de fichier)
- ✅ File upload capability (clients can upload files)

Fichiers statiques / Dossiers
- ✅ Autoindex (listing)
- ✅ Index par défaut
- ✅ Appliquer root/index par location
- ✅ Serve fully static website

Gestion des erreurs
- ✅ Pages d erreur par défaut
- ✅ Status line cohérente
- ✅ Codes: 404, 405, 413, 500, 408 (Timeout)
- ✅ client_max_body_size -> 413 (Parsing et validation implémentés)
- ✅ Accurate HTTP response status codes

Configuration (.conf)
- ✅ Parsing du .conf basique
- ✅ server_name
- ✅ client_max_body_size
- ✅ return (redirect 301/302)
- [ ] upload_store (ou équivalent): pas de parsing
- [ ] cgi_pass / mapping par extension (.php/.py): pas de parsing
- ✅ root/index/autoindex par location
- ✅ allowed_methods par location
- ✅ listen multi-ports
- ✅ Listen to multiple ports (different content delivery)
- ✅ Configuration file support (mandatory)
- ✅ Default error pages provided
- ✅ Required HTTP methods: GET, POST, DELETE implemented
- ✅ Non-blocking server (never hangs indefinitely)
- ✅ Single poll/epoll for all I/O operations
- ✅ Monitor reading and writing simultaneously
- ✅ No read/write without poll readiness check

CGI
- ✅ Implémenter au moins un CGI (python) - Implémentation basique opérationnelle
- ✅ fork/execve + pipe capture STDOUT (GetMethodCGI())
- ✅ Déchunker la requête avant CGI (body déjà reconstruit)
- ✅ Détection extension + extraction script
- [ ] Variables d'environnement supplémentaires à ajouter: PATH_INFO, SCRIPT_FILENAME, SERVER_SOFTWARE, REMOTE_ADDR, REMOTE_PORT, CONTENT_LENGTH dynamique
- [ ] chdir vers dossier contenant le script avant execve
- [ ] Timeout d'exécution (kill si dépasse X secondes)
- [ ] Gestion erreurs execve (stat script, 404 ou 502 selon cas)
- [ ] Support POST vers CGI (actuellement seulement GET)

Priorités immédiates
**MANDATORY REQUIREMENTS COMPLETED:**
- ✅ Core server functionality (non-blocking, epoll-based)
- ✅ HTTP/1.0+ compatibility with proper status codes
- ✅ Static website serving capability
- ✅ File upload/download (GET/POST/DELETE)
- ✅ Multi-port listening and configuration file support
- ✅ Browser compatibility and proper error handling

**REMAINING FOR FULL COMPLETION:**
- 1) Parsing `upload_store` (chemin stockage uploads configurable)
- 2) Parsing `cgi_pass` (extension -> programme CGI)
- 3) Variables d'environnement CGI complètes
- 4) chdir + timeout de sécurité CGI
- 5) Support POST pour CGI + Content-Length dynamique
- 6) Tests intensifs (latence, 100+ connexions, upload > client_max_body_size, CGI stress)